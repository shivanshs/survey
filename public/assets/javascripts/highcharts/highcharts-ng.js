"undefined"!=typeof module&&"undefined"!=typeof exports&&module.exports===exports&&(module.exports="highcharts-ng"),function(){"use strict";function t(){return{indexOf:function(t,i,n){void 0===n&&(n=0),0>n&&(n+=t.length),0>n&&(n=0);for(var e=t.length;e>n;n++)if(n in t&&t[n]===i)return n;return-1},prependMethod:function(t,i,n){var e=t[i];t[i]=function(){var t=Array.prototype.slice.call(arguments);return n.apply(this,t),e?e.apply(this,t):void 0}},deepExtend:function t(i,n){if(angular.isArray(n)){i=angular.isArray(i)?i:[];for(var e=0;e<n.length;e++)i[e]=t(i[e]||{},n[e])}else if(angular.isObject(n))for(var r in n)i[r]=t(i[r]||{},n[r]);else i=n;return i}}}function i(t,i){var n=0,e=function(t){var i=!1;return angular.forEach(t,function(t){angular.isDefined(t.id)||(t.id="series-"+n++,i=!0)}),i},r=["xAxis","yAxis"],a=function(i,n,e){var a={},o={chart:{events:{}},title:{},subtitle:{},series:[],credits:{},plotOptions:{},navigator:{enabled:!1}};return a=e.options?t.deepExtend(o,e.options):o,a.chart.renderTo=n[0],angular.forEach(r,function(n){angular.isDefined(e[n])&&(a[n]=angular.copy(e[n]),(angular.isDefined(e[n].currentMin)||angular.isDefined(e[n].currentMax))&&(t.prependMethod(a.chart.events,"selection",function(t){var e=this;i.$apply(t[n]?function(){i.config[n].currentMin=t[n][0].min,i.config[n].currentMax=t[n][0].max}:function(){i.config[n].currentMin=e[n][0].dataMin,i.config[n].currentMax=e[n][0].dataMax})}),t.prependMethod(a.chart.events,"addSeries",function(){i.config[n].currentMin=this[n][0].min||i.config[n].currentMin,i.config[n].currentMax=this[n][0].max||i.config[n].currentMax})))}),e.title&&(a.title=e.title),e.subtitle&&(a.subtitle=e.subtitle),e.credits&&(a.credits=e.credits),e.size&&(e.size.width&&(a.chart.width=e.size.width),e.size.height&&(a.chart.height=e.size.height)),a},o=function(t,i){var n=t.getExtremes();(i.currentMin!==n.dataMin||i.currentMax!==n.dataMax)&&t.setExtremes(i.currentMin,i.currentMax,!1)},c=function(t,i,n){(i.currentMin||i.currentMax)&&t[n][0].setExtremes(i.currentMin,i.currentMax,!0)},s=function(t){return angular.extend({},t,{data:null,visible:null})};return{restrict:"EAC",replace:!0,template:"<div></div>",scope:{config:"=",disableDataWatch:"="},link:function(n,u){var d={},f=function(i){var r,a=[];if(i){var o=e(i);if(o)return!1;if(angular.forEach(i,function(t){a.push(t.id);var i=h.get(t.id);i?angular.equals(d[t.id],s(t))?(void 0!==t.visible&&i.visible!==t.visible&&i.setVisible(t.visible,!1),i.setData(angular.copy(t.data),!1)):i.update(angular.copy(t),!1):h.addSeries(angular.copy(t),!1),d[t.id]=s(t)}),n.config.noData){var c=!1;for(r=0;r<i.length;r++)if(i[r].data&&i[r].data.length>0){c=!0;break}c?h.hideLoading():h.showLoading(n.config.noData)}}for(r=h.series.length-1;r>=0;r--){var u=h.series[r];"highcharts-navigator-series"!==u.options.id&&t.indexOf(a,u.options.id)<0&&u.remove(!1)}return!0},h=!1,g=function(){h&&h.destroy(),d={};var t=n.config||{},i=a(n,u,t),e=t.func||void 0;h=t.useHighStocks?new Highcharts.StockChart(i,e):new Highcharts.Chart(i,e);for(var o=0;o<r.length;o++)t[r[o]]&&c(h,t[r[o]],r[o]);t.loading&&h.showLoading()};g(),n.disableDataWatch?n.$watchCollection("config.series",function(t){f(t),h.redraw()}):n.$watch("config.series",function(t){var i=f(t);i&&h.redraw()},!0),n.$watch("config.title",function(t){h.setTitle(t,!0)},!0),n.$watch("config.subtitle",function(t){h.setTitle(!0,t)},!0),n.$watch("config.loading",function(t){t?h.showLoading():h.hideLoading()}),n.$watch("config.credits.enabled",function(t){t?h.credits.show():h.credits&&h.credits.hide()}),n.$watch("config.useHighStocks",function(t,i){t!==i&&g()}),angular.forEach(r,function(t){n.$watch("config."+t,function(i,n){i!==n&&i&&(h[t][0].update(i,!1),o(h[t][0],angular.copy(i)),h.redraw())},!0)}),n.$watch("config.options",function(t,i,n){t!==i&&(g(),f(n.config.series),h.redraw())},!0),n.$watch("config.size",function(t,i){t!==i&&t&&h.setSize(t.width||void 0,t.height||void 0)},!0),n.$on("highchartsng.reflow",function(){h.reflow()}),n.$on("$destroy",function(){h&&(h.destroy(),i(function(){u.remove()},0))})}}}angular.module("highcharts-ng",[]).factory("highchartsNGUtils",t).directive("highchart",["highchartsNGUtils","$timeout",i])}();